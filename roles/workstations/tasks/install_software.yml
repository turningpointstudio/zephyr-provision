---

- name: Copy FreeFileSync installer to temp
  win_copy:
    src: "FreeFileSync_14.5_[Donation_Edition]_Windows.zip"
    dest: "C:/Windows/Temp/FreeFileSync_14.5_Windows.zip"

- name: Extract FreeFileSync installer
  community.windows.win_unzip:
    src: "C:/Windows/Temp/FreeFileSync_14.5_Windows.zip"
    dest: "C:/Windows/Temp/FreeFileSync"
    creates: "C:/Windows/Temp/FreeFileSync/FreeFileSync_14.5_Windows_Setup.exe"

- name: Install FreeFileSync
  win_package:
    path: "C:/Windows/Temp/FreeFileSync/FreeFileSync_14.5_Windows_Setup.exe"
    arguments: "/S"
    state: present

- name: Remove FreeFileSync temp files
  win_file:
    path: "{{ item }}"
    state: absent
  loop:
    - "C:/Windows/Temp/FreeFileSync_14.5_Windows.zip"
    - "C:/Windows/Temp/FreeFileSync"